const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');

// Chargement des images
const backgroundImage = new Image();
const tataLeleImage = new Image();

backgroundImage.src = 'background_christmas.png';  // Chemin de l'image de fond
tataLeleImage.src = 'tata_lele.png';  // Chemin de l'image de l'hÃ©roÃ¯ne

// Chargement de la musique
const backgroundMusic = new Audio('background_music.mp3');
backgroundMusic.loop = true; // RÃ©pÃ©ter la musique en boucle
let isMusicPlaying = false; // L'Ã©tat initial de la musique (dÃ©marre en pause)

// Bouton pour activer/dÃ©sactiver la musique
const toggleMusicButton = document.getElementById('toggleMusic');
toggleMusicButton.addEventListener('click', () => {
    if (isMusicPlaying) {
        backgroundMusic.pause(); // Mettre en pause la musique
        toggleMusicButton.textContent = 'ğŸ”Š'; // IcÃ´ne son activÃ©
    } else {
        backgroundMusic.play().catch(error => {
            console.error('Erreur lors de la lecture de la musique :', error);
        });
        toggleMusicButton.textContent = 'ğŸ”‡'; // IcÃ´ne son coupÃ©
    }
    isMusicPlaying = !isMusicPlaying; // Alterner l'Ã©tat
});

// Demander une interaction de l'utilisateur pour dÃ©marrer la musique
// C'est ici que la musique dÃ©marre, grÃ¢ce Ã  l'interaction initiale (clic sur la page)
window.addEventListener('click', () => {
    if (!isMusicPlaying) {
        backgroundMusic.play().catch(error => {
            console.error('Erreur lors de la lecture automatique de la musique :', error);
        });
        toggleMusicButton.textContent = 'ğŸ”‡'; // IcÃ´ne son coupÃ©
        isMusicPlaying = true; // La musique est maintenant jouÃ©e
    }
});

// VÃ©rification du chargement de la musique
backgroundMusic.addEventListener('canplay', () => {
    console.log('Musique de fond chargÃ©e.');
});

// Variables pour le dialogue et les choix
let currentDialogueIndex = 0;
let dialogues = [
    "HO HO HO Tata LÃ©lÃ©, j'imagine que tu es prÃªte Ã  recevoir ton cadeau.",
    "Que voudrais-tu pour NoÃ«l ?"
];

let choices = [
    "Un massage prÃ¨s de Vannes (dans la limite de 60 â‚¬ bien Ã©videmment pour ne pas que les autres se sentent lÃ©sÃ©s, petite maligne).",
    "Rien, j'ai dÃ©jÃ  ce qu'il me faut."
];

let responses = [
    "Excellent choix, va voir ton Secret Santa (si tu sais qui c'est) pour lui donner la meilleure adresse de massage de Vannes. Et surtout, joyeux NoÃ«l !",
    "Ho ho ho, heureusement que tout le monde ne rÃ©agit pas comme toi, tu veux la mort du petit commerce ou quoi ? Mais bon, joyeux NoÃ«l quand mÃªme."
];

let selectedChoice = 0;
let isChoosing = false;
let isFinalMessage = false;
let showingResponse = false;

// Fonction pour redimensionner dynamiquement le canvas
function resizeCanvas() {
    canvas.width = window.innerWidth
